<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test google api</title>
</head>
<body>
    <h1>google maps api test</h1>
    <div id="map" style="width: 90%; height: 700px">
        <script type='text/javascript' 
        src="https://maps.googleapis.com/maps/api/js?key=API_KEY&callback=showMap&libraries=places&v=weekly" async defer></script>
    </div>
    </div>
    <script type='text/javascript' defer>
        let map;
        let infoWindow;
        let toronto = {lat: 43.68837525962112, lng: -79.39458371015871};

        function showMap() {
            const map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 43.684070, lng: -79.399015},
                zoom: 11,  
                minZoom: 11,
                maxZoom: 15,   
                disableDefaultUI: true,
                zoomControl: true,
            });

            var allowedBounds = new google.maps.LatLngBounds(
                new google.maps.LatLng(43.646556, -79.608743), 
                new google.maps.LatLng(43.794116, -79.117858)
            );
            var lastValidCenter = map.getCenter();

            google.maps.event.addListener(map, 'center_changed', function() {
                if (allowedBounds.contains(map.getCenter())) {
                    lastValidCenter = map.getCenter();
                    return; 

                }

                map.panTo(lastValidCenter);
            });

            var request = {
                location: toronto,
                radius: 1000,
                type: ['restaurant']
            };

            let service = new google.maps.places.PlacesService(map);
            service.nearbySearch(request, callback);


            function callback(results, status) {
            if (status == google.maps.places.PlacesServiceStatus.OK) {
                for (var i = 0; i < results.length; i++) {
                createMarker(results[i]);

                }
            }
        }

        function createMarker(place) {
            let marker = new google.maps.Marker({
                map: map,
                position: place.geometry.location
            });

            infoWindow = new google.maps.InfoWindow({ map: map });

            google.maps.event.addListener(marker, 'click', function() {
                infoWindow.setContent(place.name);
                infoWindow.open(map, this);
            });
        }

        }

        
    </script>
</body>
</html>